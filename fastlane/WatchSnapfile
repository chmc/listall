# Snapfile for watchOS screenshot automation
# Captures automated screenshots for App Store submission

# Path to Xcode project
project "./ListAll/ListAll.xcodeproj"

# Watch simulator to use
# NOTE: Device names vary by Xcode version:
# - Xcode 16.1 (CI): Apple Watch Series 11 (46mm) is available
# - Xcode 17.0+ (local): Apple Watch Series 11 (46mm)
# Fastlane will fall back to available devices if exact match not found
devices([
  "Apple Watch Series 11 (46mm)"  # Available in CI (Xcode 16.1) and local
])

# List of languages to generate screenshots for
languages([
  "en-US",
  "fi"
])

# The name of the scheme which contains the watchOS UI Tests
scheme("ListAllWatch Watch App")

# Where should the resulting screenshots be stored?
output_directory("./fastlane/screenshots/watch")

# Clear previous screenshots before generating new ones
clear_previous_screenshots(true)

# Override status bar
override_status_bar(true)

# Reinstall the app before each test run
reinstall_app(true)

# Note: test_without_building and derived_data_path are set in Fastfile
# to coordinate with the scan(build_for_testing) prebuild step
# The Fastfile will override this with test_without_building: true after pre-build

# Disable result bundle to allow Fastlane to auto-extract screenshots
# CRITICAL: xcodebuild_formatter must be disabled in Fastfile
# xcbeautify filters NSLog output that Fastlane needs to find screenshots
# When result_bundle is false, Fastlane parses logs to find "snapshot: ..." entries
result_bundle(false)

# Run only the screenshot tests
only_testing([
  "ListAllWatch_Watch_AppUITests/ListAllWatch_Watch_AppUITests/testWatchScreenshots"
])

# Run devices concurrently for speed
concurrent_simulators(false)
